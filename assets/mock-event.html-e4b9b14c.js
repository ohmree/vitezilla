import{_ as t,W as e,X as o,$ as c,a0 as p,a2 as l,Z as n,a1 as s,E as u}from"./framework-72c45ff9.js";const i={},k=l('<h1 id="event-mocking" tabindex="-1"><a class="header-anchor" href="#event-mocking" aria-hidden="true">#</a> Event Mocking</h1><h2 id="problem" tabindex="-1"><a class="header-anchor" href="#problem" aria-hidden="true">#</a> Problem</h2><p>You want to work with webextension events, but you don&#39;t want to expect calls to <code>addListener</code> and <code>removeListener</code> all the time.</p><h2 id="solution" tabindex="-1"><a class="header-anchor" href="#solution" aria-hidden="true">#</a> Solution</h2>',4),r=n("div",{class:"language-typescript line-numbers-mode","data-ext":"ts"},[n("pre",{class:"language-typescript"},[n("code",null,[n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(" beforeEach"),n("span",{class:"token punctuation"},","),s(" describe"),n("span",{class:"token punctuation"},","),s(" expect"),n("span",{class:"token punctuation"},","),s(" it "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'vitest'"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"import"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token keyword"},"type"),s(),n("span",{class:"token class-name"},"VitezillaEventOf"),n("span",{class:"token punctuation"},","),s(" mockEvent "),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"from"),s(),n("span",{class:"token string"},"'@vitezilla/webextension'"),n("span",{class:"token punctuation"},";"),s(`

`),n("span",{class:"token function"},"describe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'MyEventHandler'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"let"),s(" myEventHandler"),n("span",{class:"token operator"},":"),s(" MyEventHandler"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"let"),s(" onRemoved"),n("span",{class:"token operator"},":"),s(" VitezillaEventOf"),n("span",{class:"token operator"},"<"),n("span",{class:"token keyword"},"typeof"),s(" mockBrowser"),n("span",{class:"token punctuation"},"."),s("tabs"),n("span",{class:"token punctuation"},"."),s("onRemoved"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token keyword"},"let"),s(" onCreated"),n("span",{class:"token operator"},":"),s(" VitezillaEventOf"),n("span",{class:"token operator"},"<"),n("span",{class:"token keyword"},"typeof"),s(" mockBrowser"),n("span",{class:"token punctuation"},"."),s("tabs"),n("span",{class:"token punctuation"},"."),s("onCreated"),n("span",{class:"token operator"},">"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token function"},"beforeEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    onRemoved `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"mockEvent"),n("span",{class:"token punctuation"},"("),s("mockBrowser"),n("span",{class:"token punctuation"},"."),s("tabs"),n("span",{class:"token punctuation"},"."),s("onRemoved"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    onCreated `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"mockEvent"),n("span",{class:"token punctuation"},"("),s("mockBrowser"),n("span",{class:"token punctuation"},"."),s("tabs"),n("span",{class:"token punctuation"},"."),s("onCreated"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    myEventHandler `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"MyEventHandler"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

  `),n("span",{class:"token function"},"describe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'listeners'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"it"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'should add listeners after init'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      myEventHandler`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
      `),n("span",{class:"token function"},"expect"),n("span",{class:"token punctuation"},"("),s("onRemoved"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hasListener"),n("span",{class:"token punctuation"},"("),s("myEventHandler"),n("span",{class:"token operator"},"!"),n("span",{class:"token punctuation"},"."),s("onTabRemoved"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toBe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
      `),n("span",{class:"token function"},"expect"),n("span",{class:"token punctuation"},"("),s("onCreated"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"hasListener"),n("span",{class:"token punctuation"},"("),s("myEventHandler"),n("span",{class:"token operator"},"!"),n("span",{class:"token punctuation"},"."),s("onTabCreated"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toBe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token function"},"describe"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'onTabCreated'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"it"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},"'do stuff with new tab'"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      myEventHandler`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"init"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`

      `),n("span",{class:"token comment"},"// ..."),s(`

      onTabCreated`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"emit"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(`
        active`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
        cookieStoreId`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'default'"),n("span",{class:"token punctuation"},","),s(`
        highlighted`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
        id`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"12"),n("span",{class:"token punctuation"},","),s(`
        incognito`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"true"),n("span",{class:"token punctuation"},","),s(`
        index`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(`
        isArticle`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
        isInReaderMode`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
        lastAccessed`),n("span",{class:"token operator"},":"),s(" Date"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"now"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
        pinned`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token boolean"},"false"),n("span",{class:"token punctuation"},","),s(`
        url`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token string"},"'http://some-domain.com'"),n("span",{class:"token punctuation"},","),s(`
        windowId`),n("span",{class:"token operator"},":"),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},","),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
      `),n("span",{class:"token comment"},"// ..."),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),d=n("p",null,[s("The implementations of "),n("code",null,"addListener"),s(", "),n("code",null,"removeListener"),s(", "),n("code",null,"hasListener"),s(" and "),n("code",null,"hasListeners"),s(" are instances of "),n("code",null,"vi.fn()"),s(", so you can use them to verify calls.")],-1);function m(v,b){const a=u("CodeTabs");return e(),o("div",null,[k,c(a,{id:"12",data:[{title:"my-events.spec.ts"}]},{tab0:p(({title:f,value:h,isActive:y})=>[r]),_:1},8,["data"]),d])}const E=t(i,[["render",m],["__file","mock-event.html.vue"]]);export{E as default};
